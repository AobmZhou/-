{"remainingRequest":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\asus\\Desktop\\product\\backup\\src\\components\\Tree.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\src\\components\\Tree.vue","mtime":1626699154953},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_css-loader@3.6.0@css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_sass-loader@8.0.2@sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\product\\backup\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnJlZCB7CiAgY29sb3I6IHJlZDsKfQoueWVsbG93IHsKICBjb2xvcjogeWVsbG93Owp9Ci5ub3JtYWwgewogIGNvbG9yOiB3aGl0ZTsKfQouZHVhbndhbmcgewogIGNvbG9yOiAjYTZhOWFkOwp9Ci50aW5namkgewogIGNvbG9yOiAjYTZhOWFkOwp9Ci50cmVlYm94IHsKICAuZWwtdHJlZSB7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBmb250LWZhbWlseTogIuW+rui9r+mbhem7kSI7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzAzNzQ5OwogIH0KCiAgLmVsLWNvbGxhcHNlLWl0ZW0gewogICAgYmFja2dyb3VuZC1jb2xvcjogIzMwMzc0OSAhaW1wb3J0YW50OwogIH0KCiAgLmVsLXRyZWUtbm9kZV9fbGFiZWwgewogICAgZm9udC1zaXplOiAxNHB4OwogICAgY29sb3I6ICNmZmZmZmY7CiAgfQoKICAuZWwtdHJlZS1ub2RlID4gLmVsLXRyZWUtbm9kZV9fY29udGVudCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzAzNzQ5ICFpbXBvcnRhbnQ7CiAgfQoKICAuZWwtdHJlZS1ub2RlLmlzLWN1cnJlbnQgPiAuZWwtdHJlZS1ub2RlX19jb250ZW50IHsKICAgIGJhY2tncm91bmQtY29sb3I6ICMzNTkxODYgIWltcG9ydGFudDsKICB9CgogIC5lbC1zZWxlY3QtZHJvcGRvd25fX2l0ZW0gewogICAgaGVpZ2h0OiAyNXB4OwogICAgLypsaW5lLWhlaWdodDogMjBweDsqLwogIH0KfQo="},{"version":3,"sources":["Tree.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Tree.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"treebox\">\n    <el-tree\r\n\t  :filter-node-method=\"filterNode\"\r\n      :data=\"data\"\n      node-key=\"id\"\n      ref=\"mytree\"\n      :highlight-current=\"true\"\n      :default-expanded-keys=\"idArr\"\n      :render-content=\"renderContent2\"\n      @node-click=\"handleNodeClick\"\n    ></el-tree>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Tree\",\n\n  data() {\n    return {\n      idArr: [],\n      data: [],\n      cnt: 0,\n      mylen: 0,\n      nowtree: [],\r\n\t  filterText: '',\n    };\n  },\n  created() {\n    this.getNodeId();\n  },\n  watch: {\n    $route(data) {\n      console.log(\"rout\", data.path);\n    },\r\n\tfilterText(val) {\r\n\t    this.$refs.tree.filter(val);\r\n\t},\n  },\n  methods: {\n    getNodeId() {\n      this.cnt = 0;\n      this.$http\n        .get(\"/node/info\")\n        .then((res) => {\n          console.log(res);\n          if (res.data.code == 200) {\n            this.nowtree = [];\n            this.mylen = res.data.data.length;\n            for (var i = 0; i < res.data.data.length; i++) {\n              this.getEquipment(res.data.data[i].nodeId);\n            }\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n\n    getEquipment(nodeId) {\n      let that = this;\n      this.$http.get(\"/equipment/node/\" + nodeId + \"/info\").then((res) => {\n        if (res.data.code == 200) {\n          var nowdata = res.data.data;\n          var treenode = [];\n          var equlist = {};\n          for (var i = 0; i < nowdata.length; ++i) {\n            var noweq = nowdata[i];\n            var have_group = -1;\n            var groupId = noweq.groupId;\n\n            for (var j = 0; j < treenode.length; ++j) {\n              if (groupId == treenode[j].id) {\n                have_group = j;\n                break;\n              }\n            }\n            if (have_group == -1) {\n              have_group = treenode.length;\n              treenode.push({\n                id: groupId,\n                label: noweq.groupName,\n                children: [],\n              });\n            }\n            //group\n            var companyId = noweq.companyId;\n            var have_com = -1;\n            for (var j = 0; j < treenode[have_group].children.length; ++j) {\n              if (companyId == treenode[have_group].children[j].id) {\n                have_com = j;\n                break;\n              }\n            }\n            if (have_com == -1) {\n              have_com = treenode[have_group].children.length;\n              treenode[have_group].children.push({\n                id: companyId,\n                label: noweq.companyName,\n                children: [],\n              });\n            }\n            //company\n            var factoryId = noweq.factoryId;\n            var have_fact = -1;\n            for (\n              var j = 0;\n              j < treenode[have_group].children[have_com].children.length;\n              ++j\n            ) {\n              if (\n                factoryId ==\n                treenode[have_group].children[have_com].children[j].id\n              ) {\n                have_fact = j;\n                break;\n              }\n            }\n            if (have_fact == -1) {\n              have_fact =\n                treenode[have_group].children[have_com].children.length;\n              treenode[have_group].children[have_com].children.push({\n                id: factoryId,\n                label: noweq.factoryName,\n                children: [],\n              });\n            }\n            //factory\n            var unitId = noweq.unitId;\n            var have_uuit = -1;\n            //  console.log(treenode[have_group].children[have_com].children[have_fact])\n            for (\n              var j = 0;\n              j <\n              treenode[have_group].children[have_com].children[have_fact]\n                .children.length;\n              ++j\n            ) {\n              if (\n                unitId ==\n                treenode[have_group].children[have_com].children[have_fact]\n                  .children[j].id\n              ) {\n                have_uuit = j;\n                break;\n              }\n            }\n            if (have_uuit == -1) {\n              have_uuit =\n                treenode[have_group].children[have_com].children[have_fact]\n                  .children.length;\n              treenode[have_group].children[have_com].children[\n                have_fact\n              ].children.push({\n                id: unitId,\n                label: noweq.unitName,\n                children: [],\n              });\n            }\n            //unit\n\n            let tmp1 = {};\n            if (noweq.alarmStatus == 1) {\n              tmp1[\"icon\"] = \"iconfont icon-jinggao red\"; //危险\n              tmp1[\"title\"] = noweq.alarmAlias;\n            }\n            if (noweq.alarmStatus == 2) {\n              tmp1[\"icon\"] = \"iconfont icon-jinggao yellow\"; //警报\n              tmp1[\"title\"] = noweq.alarmAlias;\n            }\n            if (noweq.alarmStatus == 3) {\n              tmp1[\"icon\"] = \"el-icon-s-claim normal\"; //正常\n              tmp1[\"title\"] = noweq.alarmAlias;\n            }\n            if (noweq.alarmStatus == 4) {\n              tmp1[\"icon\"] = \"el-icon-warning tingji\"; //停车\n              tmp1[\"title\"] = noweq.alarmAlias;\n            }\n            if (noweq.alarmStatus == 5) {\n              tmp1[\"icon\"] = \"el-icon-error duanwang\"; //断网\n              tmp1[\"title\"] = noweq.alarmAlias;\n            }\n            treenode[have_group].children[have_com].children[\n              have_fact\n            ].children[have_uuit].children.push({\n              id: noweq.equipmentUuid,\n              label: noweq.equipmentName,\n              icon: tmp1.icon,\n              title: tmp1.title,\n              companyname: noweq.companyName,\n              factoryname: noweq.factoryName,\n            });\n            this.$set(equlist, noweq.equipmentId, noweq.equipmentUuid);\n          }\n          this.$store.state.equlist = equlist;\n\n          this.cnt += 1;\n          for (var i = 0; i < treenode.length; ++i) {\n            this.nowtree.push(treenode[i]);\n          }\n\n          if (this.cnt == this.mylen) {\n            this.data = this.nowtree;\n\n            this.data.forEach((m) => {\n              this.idArr.push(m.id);\n            }); //遍历进行二级展开\n\n            var defaultid = this.nowtree[0].children[0].children[0].children[0]\n              .children[0].id;\n            if (this.$route.query.equipmentUuid) {\n              defaultid = this.$route.query.equipmentUuid;\n            }\n            this.$router.push({ query: { equipmentUuid: defaultid } });\n            this.$store.dispatch(\"saveEquipmentInfo\", defaultid);\n            this.$store.dispatch(\"saveEquipmentDetail\", defaultid);\n            this.$store.state.companyname = this.nowtree[0].children[0].children[0].children[0].children[0].companyname;\n            this.$store.state.factoryname = this.nowtree[0].children[0].children[0].children[0].children[0].factoryname;\n            this.$nextTick(() => this.$refs.mytree.setCurrentKey(defaultid));\n          }\n        }\n      });\n    },\n    handleNodeClick(data) {\n      console.log(\"数据\", data);\n      if (data.children == undefined) {\n        this.$router.push({ query: { equipmentUuid: data.id } });\n        this.$store.dispatch(\"saveEquipmentInfo\", data.id);\n        this.$store.dispatch(\"saveEquipmentDetail\", data.id);\n        if (data.companyname != undefined) {\n          this.$store.state.companyname = data.companyname;\n          this.$store.state.factoryname = data.factoryname;\n        } else {\n          this.$store.state.companyname = \"\";\n          this.$store.state.factoryname = \"\";\n        }\n      }\n    },\n    renderContent2(i, { node, data, store }) {\n      console.warn(\"123\", data.icon, data.title);\n      return i(\"span\", [\n        i(\"span\", {\n          class: data.icon,\n          style: {\n            display: \"inline-block\",\n          },\n        }),\n        i(\n          \"span\",\n          {\n            domProps: { title: data.title },\n            style: {\n              marginLeft: \"5px\",\n              fontSize: \"13px\",\n              color: \"#ffffff\",\n            },\n          },\n          node.label\n        ),\n      ]);\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.red {\n  color: red;\n}\n.yellow {\n  color: yellow;\n}\n.normal {\n  color: white;\n}\n.duanwang {\n  color: #a6a9ad;\n}\n.tingji {\n  color: #a6a9ad;\n}\n.treebox {\n  .el-tree {\n    height: 100%;\n    font-family: \"微软雅黑\";\n    background-color: #303749;\n  }\n\n  .el-collapse-item {\n    background-color: #303749 !important;\n  }\n\n  .el-tree-node__label {\n    font-size: 14px;\n    color: #ffffff;\n  }\n\n  .el-tree-node > .el-tree-node__content {\n    background-color: #303749 !important;\n  }\n\n  .el-tree-node.is-current > .el-tree-node__content {\n    background-color: #359186 !important;\n  }\n\n  .el-select-dropdown__item {\n    height: 25px;\n    /*line-height: 20px;*/\n  }\n}\n</style>\n"]}]}